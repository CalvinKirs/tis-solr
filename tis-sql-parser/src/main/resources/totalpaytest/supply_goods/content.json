{
  "nodes": [
    {
      "id": "f451c3bd-7881-80c2-b097-93a5510154b4",
      "x": 232,
      "y": 102,
      "shape": "image",
      "img": "/images/icon/table.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "table",
          "img": "table.svg",
          "size": [
            40,
            40
          ],
          "label": "数据表"
        },
        "nodeid": "f451c3bd-7881-80c2-b097-93a5510154b4",
        "sqlcontent": "SELECT id,entity_id,self_entity_id,goods_type,bar_code,inner_code,short_code,name,spell,standard_goods_id,standard_bar_code,standard_name,unit_type,package_type,category_id,type,goods_plate_id,specification,server,path,sort_code,percentage,has_degree,is_sales,period,memo,origin,is_use,apply_time,is_valid,create_time,create_user_id,op_time,last_ver,op_user_id,op_user_name,extend_fields\nFROM goods",
        "dbid": "60",
        "tabid": "46",
        "tabname": "goods"
      },
      "label": "goods"
    },
    {
      "id": "59d97c05-7ac6-c660-3b73-178922116fbc",
      "x": 375,
      "y": 104,
      "shape": "image",
      "img": "/images/icon/table.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "table",
          "img": "table.svg",
          "size": [
            40,
            40
          ],
          "label": "数据表"
        },
        "nodeid": "59d97c05-7ac6-c660-3b73-178922116fbc",
        "sqlcontent": "SELECT id,entity_id,supplier_id,goods_id,num_unit_id,weight_unit_id,goods_num,goods_weight,price,is_relation_dmall,is_valid,create_time,create_user_id,op_time,last_ver,op_user_id,op_user_name,extend_fields\nFROM supplier_goods",
        "dbid": "60",
        "tabid": "47",
        "tabname": "supplier_goods"
      },
      "label": "supplier_goods"
    },
    {
      "id": "397f148b-45b7-3fce-c7cc-ef7a0c86d644",
      "x": 505,
      "y": 109,
      "shape": "image",
      "img": "/images/icon/table.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "table",
          "img": "table.svg",
          "size": [
            40,
            40
          ],
          "label": "数据表"
        },
        "nodeid": "397f148b-45b7-3fce-c7cc-ef7a0c86d644",
        "sqlcontent": "SELECT id,entity_id,self_entity_id,warehouse_id,goods_id,sort_code,is_valid,create_time,create_user_id,op_time,last_ver,op_user_id,op_user_name,extend_fields\nFROM warehouse_goods",
        "dbid": "60",
        "tabid": "48",
        "tabname": "warehouse_goods"
      },
      "label": "warehouse_goods"
    },
    {
      "id": "3b4b4149-5c58-aad5-0800-a3f5b59a5fcd",
      "x": 612,
      "y": 104,
      "shape": "image",
      "img": "/images/icon/table.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "table",
          "img": "table.svg",
          "size": [
            40,
            40
          ],
          "label": "数据表"
        },
        "nodeid": "3b4b4149-5c58-aad5-0800-a3f5b59a5fcd",
        "sqlcontent": "SELECT id,entity_id,goods_id,self_entity_id_list,is_valid,create_time,create_user_id,op_time,last_ver,op_user_id,op_user_name\nFROM goods_sync_shop",
        "dbid": "60",
        "tabid": "49",
        "tabname": "goods_sync_shop"
      },
      "label": "goods_sync_shop"
    },
    {
      "id": "8e95b3aa-89bf-30aa-ceed-6af5b3259e75",
      "x": 711,
      "y": 107,
      "shape": "image",
      "img": "/images/icon/table.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "table",
          "img": "table.svg",
          "size": [
            40,
            40
          ],
          "label": "数据表"
        },
        "nodeid": "8e95b3aa-89bf-30aa-ceed-6af5b3259e75",
        "sqlcontent": "SELECT id,entity_id,self_entity_id,warehouse_id,goods_id,stock_num,over_sold_num,batch_amount,stock_weight,is_valid,create_time,create_user_id,op_time,last_ver,op_user_id,op_user_name,extend_fields\nFROM stock_info",
        "dbid": "60",
        "tabid": "50",
        "tabname": "stock_info"
      },
      "label": "stock_info"
    },
    {
      "id": "6d456dc6-5180-9261-16fb-2f45c16b8d8f",
      "x": 59,
      "y": 106,
      "shape": "image",
      "img": "/images/icon/table.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "table",
          "img": "table.svg",
          "size": [
            40,
            40
          ],
          "label": "数据表"
        },
        "nodeid": "6d456dc6-5180-9261-16fb-2f45c16b8d8f",
        "sqlcontent": "SELECT id,entity_id,self_entity_id,parent_id,code,inner_code,sort_code,name,spell,memo,is_valid,create_time,create_user_id,op_time,last_ver,op_user_id,op_user_name,extend_fields\nFROM category",
        "dbid": "60",
        "tabid": "51",
        "tabname": "category"
      },
      "label": "category"
    },
    {
      "id": "2a2f892b-a4d0-bf31-9bd2-1ce92f11e0bd",
      "x": 300,
      "y": 97,
      "shape": "image",
      "img": "/images/icon/table.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "table",
          "img": "table.svg",
          "size": [
            40,
            40
          ],
          "label": "数据表"
        },
        "nodeid": "2a2f892b-a4d0-bf31-9bd2-1ce92f11e0bd",
        "sqlcontent": "SELECT id,entity_id,self_entity_id,goods_id,goods_num,unit_id,warehouse_id,match_type,price_type,is_valid,create_time,create_user_id,op_time,last_ver,op_user_id,op_user_name,extend_fields\nFROM bom_info",
        "dbid": "60",
        "tabid": "52",
        "tabname": "bom_info"
      },
      "label": "bom_info"
    },
    {
      "id": "357d80d0-db7e-d9cc-9f42-664ebf191445",
      "x": 145,
      "y": 107,
      "shape": "image",
      "img": "/images/icon/table.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "table",
          "img": "table.svg",
          "size": [
            40,
            40
          ],
          "label": "数据表"
        },
        "nodeid": "357d80d0-db7e-d9cc-9f42-664ebf191445",
        "sqlcontent": "SELECT id,entity_id,self_entity_id,bom_id,bom_goods_id,is_product,goods_id,unit_id,goods_num,is_valid,create_time,create_user_id,op_time,last_ver,op_user_id,op_user_name,extend_fields\nFROM bom_detail",
        "dbid": "60",
        "tabid": "53",
        "tabname": "bom_detail"
      },
      "label": "bom_detail"
    },
    {
      "id": "e9c3549f-30c9-d392-4554-acd7f1c26c37",
      "x": 800,
      "y": 107,
      "shape": "image",
      "img": "/images/icon/table.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "table",
          "img": "table.svg",
          "size": [
            40,
            40
          ],
          "label": "数据表"
        },
        "nodeid": "e9c3549f-30c9-d392-4554-acd7f1c26c37",
        "sqlcontent": "SELECT id,entity_id,self_entity_id,goods_id,properties,is_valid,create_time,op_time\nFROM goods_extend",
        "dbid": "60",
        "tabid": "54",
        "tabname": "goods_extend"
      },
      "label": "goods_extend"
    },
    {
      "id": "c44cabd2-24d3-4e59-bfeb-041e15420439",
      "x": 632,
      "y": 278,
      "shape": "image",
      "img": "/images/icon/cog.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "join",
          "img": "cog.svg",
          "size": [
            40,
            40
          ],
          "label": "JOIN"
        },
        "id": "c44cabd2-24d3-4e59-bfeb-041e15420439",
        "exportName": "stock_info_collapse",
        "position": {
          "x": 632,
          "y": 278
        },
        "sql": "SELECT s.goods_id,s.entity_id,\n\t        concat_ws(',',collect_list(concat_ws('_',s.warehouse_id,cast( s.create_time as STRING))))\n\t        AS stock_create_times,\n\t        concat_ws('\\;', collect_list(\n\t                          CASE WHEN s.stock_num = 0.000000\n\t                               THEN '' \n\t                               ELSE concat_ws('_',s.warehouse_id, cast(s.last_ver as STRING)) \n\t                           END ))  as stock_info_warehouse_ids\nFROM stock_info s\nWHERE s.is_valid=1 \nGROUP BY s.goods_id,s.entity_id",
        "dependencies": [
          {
            "value": "8e95b3aa-89bf-30aa-ceed-6af5b3259e75",
            "label": "8e95b3aa-89bf-30aa-ceed-6af5b3259e75"
          }
        ],
        "edgeIds": [
          "c81f8450-5156-1890-45f2-845b81900c9a"
        ]
      },
      "label": "stock_info_collapse"
    },
    {
      "id": "367afe63-9b5d-e71a-cef2-e0b440484d46",
      "x": 342,
      "y": 263,
      "shape": "image",
      "img": "/images/icon/cog.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "join",
          "img": "cog.svg",
          "size": [
            40,
            40
          ],
          "label": "JOIN"
        },
        "id": "367afe63-9b5d-e71a-cef2-e0b440484d46",
        "exportName": "supplier_collapse",
        "position": {
          "x": 342,
          "y": 263
        },
        "sql": "SELECT s.goods_id ,s.entity_id\n     ,concat_ws(',',collect_list(concat_ws('_',s.supplier_id,cast(s.create_time as STRING)))) \n\t AS supplier_ids\nFROM supplier_goods s\nWHERE s.is_valid=1 \nGROUP BY s.goods_id ,s.entity_id",
        "dependencies": [
          {
            "value": "59d97c05-7ac6-c660-3b73-178922116fbc",
            "label": "59d97c05-7ac6-c660-3b73-178922116fbc"
          }
        ],
        "edgeIds": [
          "0f0114f7-bb11-8209-4423-96b6ec95fc8b"
        ]
      },
      "label": "supplier_collapse"
    },
    {
      "id": "94deaf38-8e79-65a8-a6b2-a57de5823539",
      "x": 257,
      "y": 416,
      "shape": "image",
      "img": "/images/icon/cog.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "join",
          "img": "cog.svg",
          "size": [
            40,
            40
          ],
          "label": "JOIN"
        },
        "id": "94deaf38-8e79-65a8-a6b2-a57de5823539",
        "exportName": "supply_goods",
        "position": {
          "x": 257,
          "y": 416
        },
        "sql": "SELECT\n\t\tg.id,\n\t\tg.entity_id,\n\t\ts.supplier_ids,\n\t\tw.warehouse_ids,\n\t\tgss.self_entity_id_list as self_entity_ids,\n\t\tsic.stock_create_times,\n\t\tsic.stock_info_warehouse_ids,\n\t\tg.bar_code,\n\t\tg.inner_code,\n\t\tg.name,\n\t\tg.short_code,\n\t\tg.spell,\n\t\tg.standard_goods_id,\n\t\tg.standard_bar_code,\n\t\tg.standard_name,\n\t\tg.unit_type,\n\t\tg.package_type,\n\t\tg.category_id,\n\t\tcategory.inner_code as category_inner_code,\n\t\tg.type,\n\t\t'' as num_unit_id,\n\t\t'' as num_unit_name,\n\t\t'' as weight_unit_id,\n\t\t'' as weight_unit_name,\n\t\t'' as main_unit_id,\n\t\t'' as main_unit_name,\n\t\t'' as sub_unit_id1,\n\t\t'' as sub_unit_name1,\n\t\t'' as sub_unit_conversion1,\n\t\t'' as sub_unit_id2,\n\t\t'' as sub_unit_name2,\n\t\t'' as sub_unit_conversion2,\n\t\t'' as sub_unit_id3,\n\t\t'' as sub_unit_name3,\n\t\t'' as sub_unit_conversion3,\n\t\t'' as sub_unit_id4,\n\t\t'' as sub_unit_name4,\n\t\t'' as sub_unit_conversion4,\n\t\tg.specification,\n\t\tg.server,\n\t\tg.path,\n\t\tg.sort_code,\n\t\tg.period,\n\t\tg.memo,\n\t\tg.origin,\n\t\t'' as price_unit_no,\n\t\t'' as inventory_unit_no,\n\t\tg.percentage,\n\t\tg.has_degree,\n\t\tg.is_sales,\n\t\tg.goods_plate_id,\n\t\t'' as goods_plate_name,\n\t\tg.is_valid,\n\t\tg.create_time,\n\t\tg.op_time,\n\t\tg.last_ver,\n\t\tg.extend_fields,\n\t\tg.apply_time,\n\t\tsg.category_inner_code as standard_category_inner_code,\n\t\tg.self_entity_id,\n\t\tg.goods_type,\n\t\tge.properties as ext_props,\n\t\tg.pt,\n\t\t'0' as pmod\n\tFROM goods g \n\t  LEFT JOIN supplier_collapse s \n\t    ON ( g.entity_id = s.entity_id AND g.id = s.goods_id )\n\t  LEFT JOIN standard_goods sg \n\t    ON (g.standard_goods_id = sg.id)\n\t  LEFT JOIN warehouse_collapse w\n\t    ON ( g.entity_id = w.self_entity_id AND g.id = w.goods_id )\n\t  LEFT JOIN goods_sync_shop gss\n\t    ON ( g.entity_id = gss.entity_id \n\t       AND gss.is_valid=1 \n\t       AND g.id = gss.goods_id )\n\t\tLEFT JOIN goods_extend ge\n\t    ON ( g.entity_id = ge.entity_id\n\t       AND ge.is_valid=1\n\t       AND g.id = ge.goods_id\n\t       )\n\t   LEFT JOIN stock_info_collapse sic \n\t     ON ( g.entity_id = sic.entity_id AND g.id = sic.goods_id)\n\t   LEFT JOIN supply_category category \n\t     ON (g.entity_id = category.entity_id \n\t\t\t  AND g.category_id = category.id \n\t       AND category.is_valid=1 )\n\tWHERE  g.entity_id is not null",
        "dependencies": [
          {
            "value": "c44cabd2-24d3-4e59-bfeb-041e15420439",
            "label": "c44cabd2-24d3-4e59-bfeb-041e15420439"
          },
          {
            "value": "367afe63-9b5d-e71a-cef2-e0b440484d46",
            "label": "367afe63-9b5d-e71a-cef2-e0b440484d46"
          },
          {
            "value": "519cbe8a-4905-a749-4ff2-d75ccb266e64",
            "label": "519cbe8a-4905-a749-4ff2-d75ccb266e64"
          }
        ],
        "edgeIds": [
          "dfcc16e6-8c44-23a4-92eb-30fb149d35b8",
          "34febd57-bf08-4ed1-92f5-1aaded793fa8",
          "b9e22eda-cc2b-9591-cf15-505ddc82e98a"
        ]
      },
      "label": "supply_goods"
    },
    {
      "id": "519cbe8a-4905-a749-4ff2-d75ccb266e64",
      "x": 446,
      "y": 276,
      "shape": "image",
      "img": "/images/icon/cog.svg",
      "size": [
        40,
        40
      ],
      "style": {
        "cursor": "pointer"
      },
      "nodeMeta": {
        "nodeMeta": {
          "type": "join",
          "img": "cog.svg",
          "size": [
            40,
            40
          ],
          "label": "JOIN"
        },
        "id": "519cbe8a-4905-a749-4ff2-d75ccb266e64",
        "exportName": "warehouse_collapse",
        "position": {
          "x": 446,
          "y": 276
        },
        "sql": "SELECT w.goods_id ,w.self_entity_id\n    ,concat_ws(',',collect_list(\n\t                concat_ws('_',w.warehouse_id,cast(w.create_time as STRING))))\n\t AS warehouse_ids\nFROM warehouse_goods w\nWHERE w.is_valid=1 \nGROUP BY w.goods_id ,w.self_entity_id",
        "dependencies": [
          {
            "value": "397f148b-45b7-3fce-c7cc-ef7a0c86d644",
            "label": "397f148b-45b7-3fce-c7cc-ef7a0c86d644"
          }
        ],
        "edgeIds": [
          "2d957d4b-4a4b-dcd3-90b1-d61d07971d12"
        ]
      },
      "label": "warehouse_collapse"
    }
  ],
  "edges": [
    {
      "id": "c81f8450-5156-1890-45f2-845b81900c9a",
      "source": "c44cabd2-24d3-4e59-bfeb-041e15420439",
      "target": "8e95b3aa-89bf-30aa-ceed-6af5b3259e75",
      "style": {
        "endArrow": true
      },
      "startPoint": {
        "x": 641.2397660818714,
        "y": 258
      },
      "endPoint": {
        "x": 701.7602339181286,
        "y": 127
      }
    },
    {
      "id": "0f0114f7-bb11-8209-4423-96b6ec95fc8b",
      "source": "367afe63-9b5d-e71a-cef2-e0b440484d46",
      "target": "59d97c05-7ac6-c660-3b73-178922116fbc",
      "style": {
        "endArrow": true
      },
      "startPoint": {
        "x": 346.1509433962264,
        "y": 243
      },
      "endPoint": {
        "x": 370.8490566037736,
        "y": 124
      }
    },
    {
      "id": "dfcc16e6-8c44-23a4-92eb-30fb149d35b8",
      "source": "94deaf38-8e79-65a8-a6b2-a57de5823539",
      "target": "c44cabd2-24d3-4e59-bfeb-041e15420439",
      "style": {
        "endArrow": true
      },
      "startPoint": {
        "x": 277,
        "y": 408.64
      },
      "endPoint": {
        "x": 612,
        "y": 285.36
      }
    },
    {
      "id": "34febd57-bf08-4ed1-92f5-1aaded793fa8",
      "source": "94deaf38-8e79-65a8-a6b2-a57de5823539",
      "target": "367afe63-9b5d-e71a-cef2-e0b440484d46",
      "style": {
        "endArrow": true
      },
      "startPoint": {
        "x": 268.1111111111111,
        "y": 396
      },
      "endPoint": {
        "x": 330.8888888888889,
        "y": 283
      }
    },
    {
      "id": "b9e22eda-cc2b-9591-cf15-505ddc82e98a",
      "source": "94deaf38-8e79-65a8-a6b2-a57de5823539",
      "target": "519cbe8a-4905-a749-4ff2-d75ccb266e64",
      "style": {
        "endArrow": true
      },
      "startPoint": {
        "x": 277,
        "y": 401.18518518518516
      },
      "endPoint": {
        "x": 426,
        "y": 290.81481481481484
      }
    },
    {
      "id": "2d957d4b-4a4b-dcd3-90b1-d61d07971d12",
      "source": "519cbe8a-4905-a749-4ff2-d75ccb266e64",
      "target": "397f148b-45b7-3fce-c7cc-ef7a0c86d644",
      "style": {
        "endArrow": true
      },
      "startPoint": {
        "x": 453.0658682634731,
        "y": 256
      },
      "endPoint": {
        "x": 497.9341317365269,
        "y": 129
      }
    }
  ],
  "topologyName": "supply_goods"
}