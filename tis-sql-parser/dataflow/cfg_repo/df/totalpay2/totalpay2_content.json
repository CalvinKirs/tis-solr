{"nodes":[{"id":"8c16a8c1-4cd4-d4ae-9213-bb0d15ea7264","x":398,"y":112,"shape":"image","img":"/images/icon/table.svg","size":[40,40],"style":{"cursor":"pointer"},"nodeMeta":{"nodeMeta":{"type":"table","img":"table.svg","size":[40,40],"label":"数据表"},"nodeid":"8c16a8c1-4cd4-d4ae-9213-bb0d15ea7264","sqlcontent":"SELECT order_id,global_code,simple_code,seat_code,code,curr_date,totalpay_id,seat_id,people_count,open_time,status,memo,inner_code,menutime_id,worker_id,end_time,feeplan_id,op_user_id,order_from,order_kind,area_id,name,mobile,tel,is_autocommit,send_time,address,paymode,outfee,sender_id,customerregister_id,waitingorder_id,send_status,audit_status,is_hide,entity_id,is_valid,create_time,op_time,last_ver,load_time,modify_time,is_limittime,scan_url,seat_mark,reservetime_id,is_wait,is_print,book_id,reserve_id,orign_id,reserve_status,ext\n FROM orderdetail","dbid":"58","tabid":"57","tabname":"orderdetail"},"label":"orderdetail"},{"id":"d8d9d29a-a45a-203e-0d0a-65e2a35b1877","x":625,"y":93,"shape":"image","img":"/images/icon/table.svg","size":[40,40],"style":{"cursor":"pointer"},"nodeMeta":{"nodeMeta":{"type":"table","img":"table.svg","size":[40,40],"label":"数据表"},"nodeid":"d8d9d29a-a45a-203e-0d0a-65e2a35b1877","sqlcontent":"SELECT totalpay_id,curr_date,outfee,source_amount,discount_amount,result_amount,recieve_amount,ratio,status,entity_id,is_valid,create_time,op_time,last_ver,op_user_id,discount_plan_id,operator,operate_date,card_id,card,card_entity_id,is_full_ratio,is_minconsume_ratio,is_servicefee_ratio,invoice_code,invoice_memo,invoice,over_status,is_hide,load_time,modify_time,printnum1,printnum2,coupon_discount,ext,discount_amount_receivables,result_amount_receivables\n FROM totalpayinfo","dbid":"58","tabid":"56","tabname":"totalpayinfo"},"label":"totalpayinfo"},{"id":"1084af2d-875f-8b0f-9573-db5e42391d12","x":774,"y":117,"shape":"image","img":"/images/icon/table.svg","size":[40,40],"style":{"cursor":"pointer"},"nodeMeta":{"nodeMeta":{"type":"table","img":"table.svg","size":[40,40],"label":"数据表"},"nodeid":"1084af2d-875f-8b0f-9573-db5e42391d12","sqlcontent":"SELECT instance_id,order_id,batch_msg,type,ext,waitinginstance_id,kind,parent_id,pricemode,name,makename,taste,spec_detail_name,num,account_num,unit,account_unit,price,member_price,fee,ratio,ratio_fee,ratio_cause,status,kindmenu_id,kindmenu_name,menu_id,memo,is_ratio,entity_id,is_valid,create_time,op_time,last_ver,load_time,modify_time,draw_status,bookmenu_id,make_id,make_price,prodplan_id,is_wait,specdetail_id,specdetail_price,makeprice_mode,original_price,is_buynumber_changed,ratio_operator_id,child_id,kind_bookmenu_id,specprice_mode,worker_id,is_backauth,service_fee_mode,service_fee,orign_id,addition_price,has_addition,seat_id\n FROM instancedetail","dbid":"58","tabid":"62","tabname":"instancedetail"},"label":"instancedetail"},{"id":"1cfb5ebe-76d7-83a3-efad-24127c4de930","x":590,"y":253,"shape":"image","img":"/images/icon/cog.svg","size":[40,40],"style":{"cursor":"pointer"},"nodeMeta":{"nodeMeta":{"type":"join","img":"cog.svg","size":[40,40],"label":"JOIN"},"id":"1cfb5ebe-76d7-83a3-efad-24127c4de930","exportName":"order_joiner","position":{"x":590,"y":253},"sql":"SELECT t.totalpay_id,t.result_amount,t.recieve_amount,o.open_time,o.end_time\n    ,  i.customer_ids\n FROM orderdetail o \n  INNER JOIN totalpayinfo t  ON (t.totalpay_id = o.totalpay_id)\n  LEFT JOIN instance_joiner i ON (o.order_id = i.order_id)","dependencies":[{"value":"8c16a8c1-4cd4-d4ae-9213-bb0d15ea7264","label":"orderdetail"},{"value":"d8d9d29a-a45a-203e-0d0a-65e2a35b1877","label":"totalpayinfo"},{"value":"2cec671a-66a3-7618-ef10-452ed0f61d03","label":"instance_joiner"}],"edgeIds":["282d699a-2507-6d6b-be15-ccaadc2155b5","f57bba2c-929b-964b-3fa5-963555fa3da4","2989a601-e7cc-87f7-8e2c-79616e65be29"]},"label":"order_joiner"},{"id":"2cec671a-66a3-7618-ef10-452ed0f61d03","x":741,"y":213,"shape":"image","img":"/images/icon/cog.svg","size":[40,40],"style":{"cursor":"pointer"},"nodeMeta":{"nodeMeta":{"type":"join","img":"cog.svg","size":[40,40],"label":"JOIN"},"id":"2cec671a-66a3-7618-ef10-452ed0f61d03","exportName":"instance_joiner","position":{"x":741,"y":213},"sql":"SELECT i.order_id, concat_ws(',',collect_set( split(i.batch_msg,'\\\\|')[3])) as customer_ids\n FROM \n   instancedetail i \n WHERE   i.is_valid= 1 \n GROUP BY i.order_id","dependencies":[{"value":"1084af2d-875f-8b0f-9573-db5e42391d12","label":"instancedetail"}],"edgeIds":["f14850be-d0a7-1b25-1418-33d1834e1e5d"]},"label":"instance_joiner"}],"edges":[{"id":"f14850be-d0a7-1b25-1418-33d1834e1e5d","source":"2cec671a-66a3-7618-ef10-452ed0f61d03","target":"1084af2d-875f-8b0f-9573-db5e42391d12","style":{"endArrow":true},"startPoint":{"x":747.875,"y":193},"endPoint":{"x":767.125,"y":137}},{"id":"282d699a-2507-6d6b-be15-ccaadc2155b5","source":"1cfb5ebe-76d7-83a3-efad-24127c4de930","target":"8c16a8c1-4cd4-d4ae-9213-bb0d15ea7264","style":{"endArrow":true},"startPoint":{"x":570,"y":238.3125},"endPoint":{"x":418,"y":126.6875}},{"id":"f57bba2c-929b-964b-3fa5-963555fa3da4","source":"1cfb5ebe-76d7-83a3-efad-24127c4de930","target":"d8d9d29a-a45a-203e-0d0a-65e2a35b1877","style":{"endArrow":true},"startPoint":{"x":594.375,"y":233},"endPoint":{"x":620.625,"y":113}},{"id":"2989a601-e7cc-87f7-8e2c-79616e65be29","source":"1cfb5ebe-76d7-83a3-efad-24127c4de930","target":"2cec671a-66a3-7618-ef10-452ed0f61d03","style":{"endArrow":true},"startPoint":{"x":610,"y":247.7019867549669},"endPoint":{"x":721,"y":218.2980132450331}}],"topologyName":"totalpay2"}